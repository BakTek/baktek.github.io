
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />

    <title>Paramètres de synchronisation des listes WSS dans Outlook</title>

    <link href="Styles/masterroot322b.css" type="text/css" rel="stylesheet" />
    <link href="Styles/tables7339.css" type="text/css" rel="stylesheet" />
    <link href="Styles/spxpubc27acd.css" type="text/css" rel="stylesheet" />
    <link href="Styles/accessibility2703.css" type="text/css" rel="stylesheet" />
    <link href="Styles/theme.css" type="text/css" rel="stylesheet" />
    <link href="Styles/customf519.css" type="text/css" rel="stylesheet" />

</head>
<body class="ltr">

    <table cellspacing="0" class="MS_MasterFrame" cellpadding="0" border="0">
        <tr>
            <td id="IWS_WH_Elem_GlobalLinks" class="MS_MasterGlobalLinks">
                <div />
            </td>
        </tr>
        <tr>
            <td id="IWS_WH_Elem_Header" class="MS_MasterHeader">
                <TABLE cellSpacing="0" cellPadding="0" width="780" border="0" class="MSC_SiteWidth" style="clear:left"><TR><TD class="BG_Dark"><img alt="" src="Styles/Header-short.jpg" /></TD><TD width="400" nowrap="true" class="BG_Dark" style="padding-left:20px;padding-right:20px; padding-bottom: 10px"><table cellpadding="0" cellspacing="0" width="100%" style="padding-left:10px"><tr><td><h2 id="IWS_WH_Elem_SiteTitle" class="MSC_HeaderText F_VeryLight"><span style="font-weight: normal; font-size: 18pt; color: #ffffff; font-style: normal; font-family: Arial; text-decoration: ">BakTek</span></h2></td></tr><tr><td><h5 id="IWS_WH_Elem_SiteDescription" class="MSC_HeaderDescription F_Light"><span style="font-weight: normal; font-size: 14pt; color: #ffffff; font-style: normal; font-family: Arial; text-decoration: ">Spécialiste du développement SharePoint</span></h5></td></tr></table></TD><TD class="BG_Dark" width="100%" align="right"><img alt="" src="Styles/Header-long.jpg" /></TD></TR></TABLE><TABLE cellSpacing="0" cellPadding="0" width="100%" border="0" class="BG_Base MSC_SiteWidth"><tr><td colspan="2" height="2" bgcolor="#ffffff" /></tr><tr><td colspan="2" height="2" bgcolor="#ffffff" /></tr></TABLE>
            </td>
        </tr>
        <tr style="">
            <td id="IWS_WH_Elem_TopNav" class="MS_MasterPrimaryNav">
                <table cellpadding="0" cellspacing="0" class="MSC_PrimaryNavFrame"><tr><td class="MSC_PrimaryNavLinkFrame" posId="1"><a class="MSC_PrimaryNavLink" type="1" href="index.html">Accueil</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="2"><a class="MSC_PrimaryNavLink" type="1" href="experience.html">Mon Expertise</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="3"><a class="MSC_PrimaryNavLink" type="1" href="offre.html">Mon Offre</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="4"><a class="MSC_PrimaryNavLink" type="1" href="baktek.html">Informations et Contact</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="5"><a class="MSC_PrimaryNavLink" type="1" href="partenaires.html">Partenaires</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="6"><a class="MSC_PrimaryNavLink" type="1" href="clients.html">Clients</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td class="MSC_PrimaryNavLinkFrame" posId="7"><a class="MSC_PrimaryNavLink" type="1" href="articles.html">SharePoint...</a></td><td name="IWS_Decodeable" class="MSC_PrimaryNavLeftSpace"> </td><td name="IWS_Decodeable" class="MSC_PrimaryNavRightSpace"> </td><td name="IWS_Decodeable" class="MSC_TopNavEnd"> </td></tr></table>
            </td>
        </tr>
        <tr>
            <td>
                <table cellspacing="0" cellpadding="0" border="0" style="width:100%">
                    <tr>
                        <td id="IWS_WH_Elem_LeftNav" class="MS_MasterLeftNav" style="width:0px;white-space: nowrap"></td>
                        <td class="MS_MasterBody">
                            <a name="mainContent"></a>
                            <div id="IWS_WH_Elem_Content" class="MSC_Body">
                                <div id="IWS_WH_ZoneRowContainer">
                                    <table class="MS_WH_ZoneRow">
                                        <tbody>
                                            <tr>
                                                <td style="WIDTH: 1%" colspan="1" rowspan="1" class="MS_WH_ZoneSpacing" />
                                                <td valign="top" style="WIDTH: 98%" colspan="1" rowspan="1">
                                                    <div class="MS_WH_ZoneContent">
                                                        <div id="General_Content"><font face="Georgia" size="4" color="#000033"><strong>Paramètres de synchronisation des listes WSS dans Outlook <hr /></strong></font></div><div> </div><div> </div><div><font color="#000033">J'ai eu l'occasion récemment de faire quelques recherches sur les délais de synchronisation des listes SharePoint 2007 synchronisées dans Outlook 2007. Ne trouvant pas beaucoup d'articles sur le sujet sur le Web, j'ai dû chercher les informations quelque temps ; quelques tests ont également été nécessaires. Voici donc un résumé de mes trouvailles :</font></div><div> </div><ol>
                                                            <li>
                                                                <font color="#000033">La règle de base est qu’Outlook 2007 ne peut déclencher une mise à jour que sur les événements suivants :<br />     </font><font color="#000033">a. Sauvegarde d’un fichier dans la liste depuis Outlook<br />     </font><font color="#000033">
                                                                    b. Navigation dans Outlook vers le dossier d’une liste<br />     c. Send/Receive programmé :<br />
                                                                    <img src="Images/Articles/Outlook Send-Receive Settings.png" alt="Groupes Outlook Outlook 'send/receive'" />
                                                                    <br />
                                                                </font><font color="#000033">d. Send/Receiver manuel (F9)<br /></font>
                                                            </li>
                                                            <li><font color="#000033">Il existe deux valeurs qu’Outlook 2007 utilise pour contrôler la fréquence de mise à jour : TTL (Time to Live) et ASI (Automatic Sync Interval). Ces deux valeurs viennent du serveur SharePoint (ces valeurs sont globales à la ferme).<br /></font></li>
                                                            <li><font color="#000033">Par défaut, TTL est à 0<br /></font></li>
                                                            <li><font color="#000033">Par défaut ASI est à 180 (minutes)<br /></font></li>
                                                            <li><font color="#000033">TTL est utilisé par Outlook pour éviter dans tous les cas une mise à jour plus fréquente que la valeur spécifiée. Par exemple, si on commande une mise à jour manuelle et que le temps écoulé depuis la dernière mise à jour est inférieur à TTL, la mise à jour ne s’effectue pas. Idem pour une mise à jour dans tous les cas 1a, 1b, 1c et 1d ci-dessus.<br /></font></li>
                                                            <li><font color="#000033">ASI est utilisé pour éviter une mise à jour automatique (i.e. Send/Receiver programmé, cas 1c ci-dessus) plus fréquente que la valeur indiquée. Par exemple, avec un ASI à 180 minutes (le défaut), et un Send/Receiver programmé toutes les 30 minutes, les synchronisations des 30, 60, 90, 120 et 150ième minutes ne sont pas effectuées. Seules les synchronisations des minutes 0 et 180 seront réalisées. L’ASI n’est cependant pas pris en compte dans les cas 1a, 1b et 1d ci-dessus.<br /></font></li>
                                                            <li><font color="#000033">La valeur qui apparaît dans la section « Update Limit » des paramètres avancés d’un abonnement est celle du TTL<br /></font></li>
                                                            <li>
                                                                <font color="#000033">
                                                                    Lors de l’ajout de l’abonnement, même si un TTL est publié par le serveur, la valeur n’apparaît pas dans la boîte de dialogue : en fait, Outlook n’a pas encore eu l’occasion de demander cette information au serveur. Ce n’est que plus tard (lors de la première synchronisation) qu’Outlook aura accès à cette valeur. On peut alors y accéder par : « Tools -&gt; Account Settings… -&gt; SharePoint Lists -&gt; Change… » :<br /><br />
                                                                    <img src="Images/Articles/Outlook SharePoint Lists Sync Settings.png" alt"Paramètres=alt"Paramètres Outlook=Outlook de=de synchronisation=synchronisation de=de listes=listes SharePoint"=SharePoint" />
                                                                    <br /><br />
                                                                </font>
                                                            </li>
                                                            <li><font color="#000033">Pour spécifier les valeurs TTL et ASI sur le serveur SharePoint, il faut utiliser stsadm pour positionner les propriétés min-time-between-syncs (TTL) et recommended-time-between-syncs (ASI). Par exemple, pour forcer un TTL d’une heure :<br /><br /><em>stsadm -o setproperty -pn min-time-between-syncs -pv "60"</em><br /></font></li>
                                                            <li><font color="#000033">La clé de registre « HKCU\Software\Microsoft\Office\12.0\Outlook\Options\WSS\IgnoreTTL » permet de positionner la valeur du « Update Limit » par défaut (0 = coché, 1 = décoché)<br /></font></li>
                                                            <li>
                                                                <font color="#000033">
                                                                    La clé « HKCU\Software\Policies\Microsoft\Office\12.0\Outlook\Options\WSS\IgnoreTTL » est plus intéressante puisqu’elle permet de bloquer pour l’utilisateur la possibilité de choisir entre l’utilisation ou non de TTL. En positionnant cette clé à 0, on force l’utilisation de la valeur TTL envoyée par le serveur, et on empêche l’utilisateur de modifier cela (cliquer pour agrandir) :<br /><br />
                                                                    <img src="Images/Articles/Outlook SharePoint Lists Sync.png" alt="Paramètres Outlook dans la base de registre pour la synchronisation de listes SharePoint" />
                                                                    <div><br /><p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><font size="3"><font face="Calibri">La logique derrière cette implémentation est qu’il faut d’une part limiter le nombre de requêtes de synchronisation vers le serveur, et d’autre part essayer d’avoir les données les plus récentes sur le client. C’est pour cela que les moyens de synchronisation privilégiés sont les 1a et 1b ci-dessus. Cependant, il est laissé à l’administrateur SharePoint la possibilité de diminuer le nombre de requête sur son serveur en positionnant le TTL à une valeur supérieure à 0. Enfin, sans action de la part de l’utilisateur (cas 1c), c’est l’ASI qui entre en jeu, et dans ce cas, la valeur par défaut (180 minutes) limite le nombre de requêtes, quelque soit l’intervalle de programmation du Send/Receive. </font></font></p><p /></div>
                                                                </font><p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><font face="Calibri" size="3">Cependant, l’utilisateur a la possibilité de ne pas tenir compte des paramètres du serveur en décochant la case « Update Limit ». Cette possibilité laissée à l’utilisateur peut-être supprimée en positionnant la clé de registre <em>IgnoreTTL</em> (dans \Policies) à 0.</font></p><p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal"><font face="Calibri" size="3">Enfin, pour les plus curieux, sachez qu'Outlook utilise pour la synchro les Web services de WSS, et particulièrement la méthode <em>GetListItemChangesSinceToken</em> de Lists.asmx (voir <a href="http://blogs.msdn.com/sharepointdeveloperdocs/archive/2008/01/21/synchronizing-with-windows-sharepoint-services-part-1.aspx">Synchronizing with Windows SharePoint Services</a>). C'est cette méthode qui permet de récupérer la liste des derniers éléments à refraîchir, ainsi que les paramètres TTL et ASI. Cela explique pourquoi Outlook ne connait pas ces valeurs avant d'avoir fait une première synchro. Dans le cas d'une bibliothèque de documents, Outlook utilise <em>GetListItemChangesSinceToken</em> pour récupérer la liste des documents puis va ensuite récupérer le document à l'URL trouvée dans la réponse. Voici ce que cela donne :<br /></font></p><p style="MARGIN: 0cm 0cm 10pt" class="MsoNormal">
                                                                    <font face="Calibri" size="3">
                                                                        <img src="Images/Articles/Outlook SharePoint List Sync Fiddler Trace.png" alt="Trace Fiddler de la syncrhonisation de listes SharePoint depuis Outlook" style="max-width:800px;" />
                                                                    </font>
                                                                </p>
                                                            </li>
                                                        </ol>
                                                    </div>
                                                </td>
                                                <td style="WIDTH: 1%" colspan="1" rowspan="1" class="MS_WH_ZoneSpacing" />
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <td id="IWS_WH_Elem_Footer" colspan="2" class="MS_MasterFooter">
                <div class="MSC_FooterFrame">
                    <span id="IWS_WH_Elem_FooterLinks">

                    </span>
                    <div id="IWS_WH_Elem_FooterText" class="MSC_FooterText">
                        <span style="font-weight: normal; font-size: 10pt; color: #ffffff; font-style: normal; font-family: Arial; text-decoration:none ">BakTek - Expertise en développement SharePoint - contact@baktek.fr</span>
                    </div>
                </div>
            </td>
        </tr>

    </table>
</body>
</html>
